/*! For license information please see main.c102e6c8d0a811626dc6.bundle.js.LICENSE.txt */
(()=>{var t,e={3093:(t,e,s)=>{"use strict";var i=s(2260);class o extends i.Scene{constructor(){super({key:"BootScene"})}preload(){this.load.json("assets","assets/assets.json")}create(){this.registry.set("options-music",!0),this.registry.set("options-sound",!0),this.registry.set("showVideo",!1),this.registry.set("draw-keypoints",!1),this.registry.set("draw-skeleton",!1),this.registry.set("master-sound-volume",.7),this.registry.set("player-points",0),this.registry.set("gameover",!1),this.scene.start("preload")}}var n=function(t,e,s,i){return new(s||(s=Promise))((function(o,n){function r(t){try{h(i.next(t))}catch(t){n(t)}}function a(t){try{h(i.throw(t))}catch(t){n(t)}}function h(t){var e;t.done?o(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(r,a)}h((i=i.apply(t,e||[])).next())}))};var r=s(6452),a=(s(1241),function(t,e,s,i){return new(s||(s=Promise))((function(o,n){function r(t){try{h(i.next(t))}catch(t){n(t)}}function a(t){try{h(i.throw(t))}catch(t){n(t)}}function h(t){var e;t.done?o(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(r,a)}h((i=i.apply(t,e||[])).next())}))});const h=["leftWrist","rightWrist"],c=["leftShoulder","rightShoulder"];let d=new Phaser.Geom.Line(1,1,2,2),u=new Phaser.Geom.Circle(1,1,1),l=!1,p=!1,g=!1,m=[];const f=(t,e,s,i)=>a(void 0,void 0,void 0,(function*(){if(s||(s=yield r.zD()),e.registry.get("gameover"))return l=!1,p=!1,void(g=!1);const o=x(e).cameras.main.width,n=x(e).cameras.main.height;if(!i){const t=document.querySelector("#output");t.width=o,t.height=n,i=t.getContext("2d")}const a=yield s.estimateSinglePose(t,1,!0,16);i&&e.registry.get("showVideo")&&w(i,t,o,n);const h=a.score,c=a.keypoints;if(h>=.5&&(e.registry.get("draw-keypoints")&&i&&O(c,.5,e),S(c,.5,e),Array.isArray(c))){const t=b(c),s=P(c);_(s[0],s[1],e),v(t[0],s)&&v(t[1],s)?k(e,"up"):y(t[0],s)&&y(t[1],s)&&k(e,"down")}requestAnimationFrame((()=>f(t,e,s,i)))})),v=(t,e)=>{let s=t.position.y,i=e[0].position.y,o=e[1].position.y;return s<i&&s<o},y=(t,e)=>{let s=t.position.y,i=e[0].position.y,o=e[1].position.y;return s>i&&s>o},w=(t,e,s=640,i=480)=>{t.clearRect(0,0,s,i),t.save(),t.scale(1,1),t.translate(0,0),t.drawImage(e,0,0,s,i),t.restore()},b=t=>{const e=t.filter((t=>h.includes(t.part)));return 2!==e.length?[]:"leftWrist"===e[0].part?[e[0],e[1]]:[e[1],e[0]]},P=t=>{const e=t.filter((t=>c.includes(t.part)));return 2!==e.length?[]:"leftShoulder"===e[0].part?[e[0],e[1]]:[e[1],e[0]]},k=(t,e)=>{const s=x(t);s&&("up"===e?s.wingUp():"down"===e?s.wingDown():s.moveStraight())},x=t=>!!t.scene.isActive(t.scene.current)&&t.scene.getScene(t.scene.current),O=(t,e,s,i=1)=>{for(let o=0,n=t.length;o<n;++o){let n=t[o];if(n.score<e)continue;let{y:r,x:a}=n.position;C(s,r*i,a*i,5,"red")}},S=(t,e,s,i=1)=>{const o=r._X(t,e);m.forEach((t=>t.destroy())),m=[],l||(l=x(s).add.graphics({lineStyle:{width:4,color:16711935}})),l.clear(),o.forEach((t=>{G(l,B(t[0].position),B(t[1].position),s,"green",i)}))},_=(t,e,s,i=1)=>{},B=({y:t,x:e})=>[t,e],C=(t,e,s,i,o)=>{t.scene?(g||(g=x(t).add.graphics({fillStyle:{alpha:1,color:11141290}})),u.setTo(s,e,i),g.clear(),g.fillCircleShape(u)):(t.beginPath(),t.arc(s,e,i,0,2*Math.PI),t.fillStyle=o,t.fill())},G=(t,[e,s],[i,o],n,r,a)=>{n.scene?(d.setTo(s,e,o,i),t.defaultStrokeColor=16711680,t.defaultStrokeWidth=4,t.strokeLineShape(d)):(n.beginPath(),n.moveTo(s*a,e*a),n.lineTo(o*a,i*a),n.lineWidth=5,n.strokeStyle=r,n.stroke())};class T extends Phaser.Scene{constructor(){super({key:"preload"})}preload(){this.loadAssets(this.cache.json.get("assets")),this.createProgressbar(this.centerX(),this.centerY()+200)}centerX(){return this.sys.game.config.width/2}centerY(){return this.sys.game.config.height/2}createProgressbar(t,e){let s=t-200,i=e-10,o=new Phaser.Geom.Rectangle(s-2,i-2,404,24);this.add.graphics({lineStyle:{width:5,color:11184810}}).strokeRectShape(o);let h=this.add.graphics(),c=function(t){h.clear(),h.fillStyle(16777215,1),h.fillRect(s,i,400*t,20)};this.load.on("progress",c),this.load.once("complete",(()=>{return t=this,e=void 0,i=function*(){const t=document.querySelector("video");this.game.videoSrc=yield((t,e,s)=>n(void 0,void 0,void 0,(function*(){return yield((t,e,s)=>n(void 0,void 0,void 0,(function*(){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("No Media Devices detected");t.width=e,t.height=s;const i=yield navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:"environment",width:e,height:s}});return t.srcObject=i,new Promise((e=>{t.onloadedmetadata=()=>{e(t)}}))})))(t,e,s)})))(t,this.cameras.main.width,this.cameras.main.height),yield(this.game.videoSrc,a(void 0,void 0,void 0,(function*(){yield r.zD()}))),this.load.off("progress",c),this.scene.start("menu")},new((s=void 0)||(s=Promise))((function(o,n){function r(t){try{h(i.next(t))}catch(t){n(t)}}function a(t){try{h(i.throw(t))}catch(t){n(t)}}function h(t){var e;t.done?o(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(r,a)}h((i=i.apply(t,e||[])).next())}));var t,e,s,i}),this)}loadAssets(t){Object.keys(t).forEach((function(e){Object.keys(t[e]).forEach((function(s){let i=t[e][s];"atlas"===e||"unityAtlas"===e||"bitmapFont"===e||"spritesheet"===e||"multiatlas"===e?this.load[e](s,i[0],i[1]):"audio"===e?i.hasOwnProperty("opus")&&this.sys.game.device.audio.opus?this.load[e](s,i.opus):i.hasOwnProperty("webm")&&this.sys.game.device.audio.webm?this.load[e](s,i.webm):i.hasOwnProperty("ogg")&&this.sys.game.device.audio.ogg?this.load[e](s,i.ogg):i.hasOwnProperty("wav")&&this.sys.game.device.audio.wav&&this.load[e](s,i.wav):"html"===e?this.load[e](s,i[0],i[1],i[2]):this.load[e](s,i)}),this)}),this)}}class j extends Phaser.GameObjects.Image{constructor(t,e,s,i,o){o||(o={up:0,down:2,over:1,out:0}),super(i,t,e,s,o.up),this._frames=o,this.setInteractive({useHandCursor:!0}),this.on("pointerup",(()=>{this.setFrame(this._frames.up),this.emit("click",this)}),this),this.on("pointerdown",(()=>{this.setFrame(this._frames.down)}),this),this.on("pointerover",(()=>{this.setFrame(this._frames.over),this.emit("over")}),this),this.on("pointerout",(()=>{this.setFrame(this._frames.out)}),this),i.add.existing(this)}}class F extends Phaser.GameObjects.Image{constructor(t,e,s,i,o,n){o||(o={on:0,off:1}),super(i,t,e,s,o.on),this.value=void 0!==n&&n,this._frames=o,this.setValueFrame(),this.setInteractive({useHandCursor:!0}),this.on("pointerup",(()=>{this.value=!this.value,this.setValueFrame(),this.emit("changed",this,this.value)}),this),this.on("pointerover",(()=>{this.emit("over"),this.setTint(255)}),this),this.on("pointerout",(()=>{this.clearTint()}),this),i.add.existing(this)}setValueFrame(){this.setFrame(this.value?this._frames.on:this._frames.off)}}class M extends Phaser.Scene{constructor(){super({key:"menu"})}create(){this.bg=this.add.tileSprite(0,0,this.cameras.main.width,this.cameras.main.height,"background"),this.bg.setOrigin(0,0),this.sound.setVolume(this.registry.get("master-sound-volume")),this.soundBtnOver=this.sound.add("btnover"),this.soundBtnClick=this.sound.add("btnclick"),this.add.sprite(this.cameras.main.centerX,100,"logo").setOrigin(.5);const t=new j(this.cameras.main.centerX,300,"menu_buttons",this,{up:"startgame_up",down:"startgame_down",over:"startgame_over",out:"startgame_up"});t.on("click",this.onStartGameClick,this),t.on("over",this.onButtonOver,this);const e=new j(this.cameras.main.centerX,400,"menu_buttons",this,{up:"options_up",down:"options_down",over:"options_over",out:"options_up"});e.on("click",this.onOptionsClick,this),e.on("over",this.onButtonOver,this);const s=new j(this.cameras.main.centerX,500,"menu_buttons",this,{up:"howto_up",down:"howto_down",over:"howto_over",out:"howto_up"});s.on("click",this.onHowtoClick,this),s.on("over",this.onButtonOver,this)}onStartGameClick(){this.sfxPlay(this.soundBtnClick),this.scene.start("game")}onOptionsClick(){this.sfxPlay(this.soundBtnClick),this.scene.start("options")}onHowtoClick(){this.sfxPlay(this.soundBtnClick),this.scene.start("howto")}onButtonOver(){this.sfxPlay(this.soundBtnOver)}sfxPlay(t){this.registry.get("options-sound")&&t.play()}update(){this.bg.tilePositionY-=.5}}class E extends Phaser.Scene{constructor(){super({key:"options"})}create(){const t=this.cameras.main.centerX;this.bg=this.add.tileSprite(0,0,this.cameras.main.width,this.cameras.main.height,"background"),this.bg.setOrigin(0,0),this.sound.setVolume(this.registry.get("master-sound-volume")),this.soundBtnOver=this.sound.add("btnover"),this.soundBtnClick=this.sound.add("btnclick"),this.add.sprite(t,100,"logo").setOrigin(.5);const e=new F(t,300,"menu_buttons",this,{on:"music_on",off:"music_off"},this.registry.get("options-music"));e.on("changed",this.onMusicChanged,this),e.on("over",this.onButtonOver,this);const s=new F(t,400,"menu_buttons",this,{on:"sfx_on",off:"sfx_off"},this.registry.get("options-sound"));s.on("changed",this.onSoundChanged,this),s.on("over",this.onButtonOver,this);const i=new j(t,500,"menu_buttons",this,{up:"goback_up",down:"goback_down",over:"goback_over",out:"goback_up"});i.on("click",this.onGoBack,this),i.on("over",this.onButtonOver,this),this.add.existing(e),this.add.existing(s)}sfxPlay(t){this.registry.get("options-sound")&&t.play()}onMusicChanged(t,e){this.registry.set("options-music",e),this.sfxPlay(this.soundBtnClick)}onSoundChanged(t,e){this.registry.set("options-sound",e),this.sfxPlay(this.soundBtnClick)}onButtonOver(){this.sfxPlay(this.soundBtnOver)}onGoBack(){this.sfxPlay(this.soundBtnClick),this.scene.start("menu")}update(){this.bg.tilePositionY-=.5}}class X extends Phaser.GameObjects.Text{constructor(t){super(t,10,10,"",{color:"white",fontSize:"16px"}),t.add.existing(this),this.setOrigin(0)}update(){this.setText(`fps: ${Math.floor(this.scene.game.loop.actualFps)}`)}}class H extends Phaser.GameObjects.Text{constructor(t){super(t,t.cameras.main.width-100,10,"",{color:"white",fontSize:"16px"}),t.add.existing(this),this.setOrigin(1,0)}update(t=0){this.setText(`Score: ${t}`)}}class V extends Phaser.Scene{constructor(){super({key:"game"}),this.birdSpeed=125,this.birdGravity=100,this.birdFlapPower=100,this.minPipeHeight=100,this.pipeDistance=[250,380],this.pipeHole=[150,200]}preload(){this.game.scene.current="game",this.sound.setVolume(this.registry.get("master-sound-volume")),this.sndPowUp1=this.sound.add("powup1"),this.sndPowUp2=this.sound.add("powup2"),this.sndPowUp3=this.sound.add("powup3"),this.sndHit=this.sound.add("hit"),this.pipeGroup=this.physics.add.group(),this.pipePool=[];for(let t=0;t<6;++t)this.pipePool.push(this.pipeGroup.create(0,0,"pipe")),this.pipePool.push(this.pipeGroup.create(0,0,"pipe")),this.placePipes(!1);this.pipeGroup.setVelocityX(-this.birdSpeed),this.anims.create({key:"flap",frames:this.anims.generateFrameNumbers("bird",{frames:["bird-1","bird-2"]}),frameRate:8,repeat:-1}),this.fpsText=new X(this),this.scoreText=new H(this)}create(){this.bird=this.physics.add.sprite(80,this.cameras.main.height/2,"bird"),this.bird.setGravityY(this.birdGravity),this.input.on("pointerdown",this.flap,this),this.score=0,this.registry.set("gameover",!1),f(this.game.videoSrc,this.game)}placePipes(t){let e=this.getRightmostPipe(),s=Phaser.Math.Between(...this.pipeHole),i=Phaser.Math.Between(this.minPipeHeight+s/2,this.cameras.main.height-this.minPipeHeight-s/2);this.pipePool[0].x=e+this.pipePool[0].getBounds().width+Phaser.Math.Between(...this.pipeDistance),this.pipePool[0].y=i-s/2,this.pipePool[0].setOrigin(0,1),this.pipePool[1].x=this.pipePool[0].x,this.pipePool[1].y=i+s/2,this.pipePool[1].setOrigin(0,0),this.pipePool=[],t&&(this.score+=1,this.sndPowUp1.play(),this.score>5&&this.pipeGroup.setVelocityX(-this.birdSpeed-5*this.score))}wingUp(){this.isWingUp=!0}wingDown(){this.isWingUp&&(this.flap(),this.isWingUp=!1)}flap(){this.bird.setVelocityY(-this.birdFlapPower),this.bird.play("flap"),console.log("YO FLAP")}getRightmostPipe(){let t=0;return this.pipeGroup.getChildren().forEach((e=>{t=Math.max(t,e.x)})),t}update(){this.physics.world.collide(this.bird,this.pipeGroup,this.die,null,this),(this.bird.y>this.cameras.main.height||this.bird.y<0)&&this.die(),this.pipeGroup.getChildren().forEach((t=>{t.getBounds().right<0&&(this.pipePool.push(t),2===this.pipePool.length&&this.placePipes(!0))})),this.fpsText.update(),this.scoreText.update(this.score)}die(){this.sndHit.play(),this.registry.set("gameover",!0),this.scene.start("gameover")}}class D extends Phaser.Scene{constructor(){super({key:"howto"})}create(){const t=this.cameras.main.centerX;this.sound.setVolume(this.registry.get("master-sound-volume")),this.soundBtnOver=this.sound.add("btnover"),this.soundBtnClick=this.sound.add("btnclick"),this.bg=this.add.tileSprite(0,0,this.cameras.main.width,this.cameras.main.height,"background"),this.bg.setOrigin(0,0),this.add.image(t,50,"howto").setOrigin(.5,0);const e=new j(t,500,"menu_buttons",this,{up:"goback_up",down:"goback_down",over:"goback_over",out:"goback_up"});e.on("click",this.onGoBack,this),e.on("over",this.onButtonOver,this)}sfxPlay(t){this.registry.get("options-sound")&&t.play()}onMusicChanged(t,e){this.registry.set("options-music",e),this.sfxPlay(this.soundBtnClick)}onSoundChanged(t,e){this.registry.set("options-sound",e),this.sfxPlay(this.soundBtnClick)}onButtonOver(){this.sfxPlay(this.soundBtnOver)}onGoBack(){this.sfxPlay(this.soundBtnClick),this.scene.start("menu")}update(){this.bg.tilePositionY-=.5}}class U extends Phaser.Scene{constructor(){super({key:"gameover"})}create(){this.bg=this.add.tileSprite(0,0,this.cameras.main.width,this.cameras.main.height,"background"),this.bg.setOrigin(0,0),this.soundBtnOver=this.sound.add("btnover"),this.soundBtnClick=this.sound.add("btnclick"),this.title=this.add.image(this.cameras.main.centerX,100,"gameover"),this.title.setOrigin(.5),this.title.setScale(1.5);const t=new j(this.cameras.main.centerX,300,"menu_buttons",this,{up:"restart_up",down:"restart_down",over:"restart_over",out:"restart_up"});t.on("click",this.onRestartClick,this),t.on("over",this.onButtonOver,this)}onRestartClick(){this.sfxPlay(this.soundBtnClick),this.time.addEvent({delay:1e3,callback(){this.scene.start("game")},callbackScope:this,loop:-1})}onButtonOver(){this.sfxPlay(this.soundBtnOver)}sfxPlay(t){this.registry.get("options-sound")&&t.play()}update(){this.bg.tilePositionY+=.5}}window.addEventListener("load",(()=>{var t;const e={title:"T-Figher",type:Phaser.WEBGL,parent:"game",backgroundColor:"#000",scale:{parent:"phaser-game",mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH,width:800,height:600},physics:{default:"arcade",arcade:{debug:!1}},render:{antialiasGL:!0,pixelArt:!1},autoFocus:!0,audio:{disableWebAudio:!1},scene:[o,T,M,E,D,V,U]};new Phaser.Game(e),null===(t=document.querySelector("#load"))||void 0===t||t.classList.add("hide")}))},9204:()=>{console.log("%c %c %c %c %c Built using phaser-project-template %c https://github.com/yandeu/phaser-project-template","background: #ff0000","background: #ffff00","background: #00ff00","background: #00ffff","color: #fff; background: #000000;","background: none")},5410:()=>{},8628:()=>{},5042:()=>{}},s={};function i(t){var o=s[t];if(void 0!==o)return o.exports;var n=s[t]={id:t,loaded:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.loaded=!0,n.exports}i.m=e,i.amdD=function(){throw new Error("define cannot be used indirect")},i.amdO={},t=[],i.O=(e,s,o,n)=>{if(!s){var r=1/0;for(d=0;d<t.length;d++){for(var[s,o,n]=t[d],a=!0,h=0;h<s.length;h++)(!1&n||r>=n)&&Object.keys(i.O).every((t=>i.O[t](s[h])))?s.splice(h--,1):(a=!1,n<r&&(r=n));if(a){t.splice(d--,1);var c=o();void 0!==c&&(e=c)}}return e}n=n||0;for(var d=t.length;d>0&&t[d-1][2]>n;d--)t[d]=t[d-1];t[d]=[s,o,n]},i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var s in e)i.o(e,s)&&!i.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),(()=>{var t={179:0};i.O.j=e=>0===t[e];var e=(e,s)=>{var o,n,[r,a,h]=s,c=0;for(o in a)i.o(a,o)&&(i.m[o]=a[o]);if(h)var d=h(i);for(e&&e(s);c<r.length;c++)n=r[c],i.o(t,n)&&t[n]&&t[n][0](),t[r[c]]=0;return i.O(d)},s=self.webpackChunkkibirdy=self.webpackChunkkibirdy||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))})(),i.O(void 0,[216],(()=>i(3093)));var o=i.O(void 0,[216],(()=>i(9204)));o=i.O(o)})();